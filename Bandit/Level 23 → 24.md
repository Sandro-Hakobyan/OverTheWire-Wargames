## Overview

In this level, we are tasked with finding the password for the next level. The password is stored in a file that is dynamically generated by a cron job. We need to understand the cron job configuration and analyze the script it runs to retrieve the password.

---

## A little bit of Theory

In this level, we revisit **cron jobs** which are scheduled tasks that execute automatically at specified intervals. The cron job configuration files are found in `/etc/cron.d/` and define the time and command to be executed.

Additionally, we are introduced to **bash variables**. A variable in bash acts as a container for a value and is defined as `var_name=var_value`. You can also store the output of a command in a variable using the syntax: `var_name=$(command)`. To access the value of a variable, we use `$var_name`.

---

## Solution

### Step 1: Check the cron jobs

We list the cron jobs in the `/etc/cron.d/` directory to identify the relevant cron job:

```bash
bandit23@bandit:~$ ls -la /etc/cron.d
```

### Output:

```
total 36
drwxr-xr-x  2 root root 4096 Jul 11  2020 .
drwxr-xr-x 87 root root 4096 May 14  2020 ..
-rw-r--r--  1 root root   62 May 14  2020 cronjob_bandit15_root
-rw-r--r--  1 root root   62 Jul 11  2020 cronjob_bandit17_root
-rw-r--r--  1 root root  120 May  7  2020 cronjob_bandit22
-rw-r--r--  1 root root  122 May  7  2020 cronjob_bandit23
-rw-r--r--  1 root root  120 May 14  2020 cronjob_bandit24
-rw-r--r--  1 root root   62 May 14  2020 cronjob_bandit25_root
-rw-r--r--  1 root root  102 Oct  7  2017 .placeholder
```

We find the relevant cron job for Bandit Level 24: `cronjob_bandit24`.

### Step 2: Examine the cron job configuration

We check the contents of `cronjob_bandit24`:

```bash
bandit23@bandit:~$ cat /etc/cron.d/cronjob_bandit24
```

### Output:

```
@reboot bandit24 /usr/bin/cronjob_bandit24.sh  &> /dev/null
* * * * * bandit24 /usr/bin/cronjob_bandit24.sh  &> /dev/null
```

This tells us that the script `/usr/bin/cronjob_bandit24.sh` is executed **every minute** as the user `bandit24`.

### Step 3: Examine the script

We now examine the script `/usr/bin/cronjob_bandit24.sh` to understand its functionality:

```bash
bandit23@bandit:~$ cat /usr/bin/cronjob_bandit24.sh
```

### Output:

```bash
#!/bin/bash

myname=$(whoami)
mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)

echo "Copying passwordfile /etc/bandit_pass/$myname to /tmp/$mytarget"

cat /etc/bandit_pass/$myname > /tmp/$mytarget
```

This script:

1. **Creates a variable `myname`** that stores the output of the `whoami` command, which will be `bandit24` when run.
2. **Creates a variable `mytarget`** that generates a filename using the `md5sum` of the string `I am user bandit24`.
3. **Copies the password** for `bandit24` from `/etc/bandit_pass/bandit24` to the file `/tmp/$mytarget`.

### Step 4: Retrieve the password

Now that we understand the script, we can reproduce the filename by executing the following:

```bash
bandit23@bandit:~$ echo I am user bandit24 | md5sum | cut -d ' ' -f 1
```

### Output:

```
d1f081c72c2f45b376f1b575d5a8a8e7
```

We now read the file that contains the password:

```bash
bandit23@bandit:~$ cat /tmp/d1f081c72c2f45b376f1b575d5a8a8e7
```

### Output:

```
gb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8
```

The password for **Level 24** is:

`gb8KRRCsshuZXI0tUuR6ypOFjiZbf3G8`

---

## Official Level Link

[Bandit Level 24](https://overthewire.org/wargames/bandit/bandit24.html)
